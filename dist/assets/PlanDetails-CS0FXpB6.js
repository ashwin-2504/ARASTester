import{j as t,c as J,I as B,a as X}from"./index-Bc1Gvzrx.js";import{a as i,R as Z,P as ee,G as ie,i as De,C as Ie,j as ce,k as ke,l as Le,m as _e}from"./vendor-C0kXtgpY.js";import{u as Y,B as _}from"./button-Ce-O98aD.js";import{g as ze,b as We,P as F,e as G,c as W,a as z,u as Oe,T as ne}from"./index-CuQU1_MK.js";import{u as He,a as se,D as Me,c as Ye,S as de,v as ue,s as Xe,K as Be,P as Fe,b as he,C as fe,d as le}from"./dnd-g6nQuZkK.js";function Ue(e,[o,r]){return Math.min(r,Math.max(o,e))}function Ve(e,o){return i.useReducer((r,n)=>o[r][n]??r,e)}var te="ScrollArea",[me]=We(te),[$e,E]=me(te),pe=i.forwardRef((e,o)=>{const{__scopeScrollArea:r,type:n="hover",dir:s,scrollHideDelay:l=600,...d}=e,[c,a]=i.useState(null),[f,u]=i.useState(null),[m,h]=i.useState(null),[x,T]=i.useState(null),[S,y]=i.useState(null),[v,w]=i.useState(0),[R,I]=i.useState(0),[g,N]=i.useState(!1),[O,H]=i.useState(!1),P=Y(o,b=>a(b)),A=ze(s);return t.jsx($e,{scope:r,type:n,dir:A,scrollHideDelay:l,scrollArea:c,viewport:f,onViewportChange:u,content:m,onContentChange:h,scrollbarX:x,onScrollbarXChange:T,scrollbarXEnabled:g,onScrollbarXEnabledChange:N,scrollbarY:S,onScrollbarYChange:y,scrollbarYEnabled:O,onScrollbarYEnabledChange:H,onCornerWidthChange:w,onCornerHeightChange:I,children:t.jsx(F.div,{dir:A,...d,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":R+"px",...e.style}})})});pe.displayName=te;var be="ScrollAreaViewport",xe=i.forwardRef((e,o)=>{const{__scopeScrollArea:r,children:n,nonce:s,...l}=e,d=E(be,r),c=i.useRef(null),a=Y(o,c,d.onViewportChange);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),t.jsx(F.div,{"data-radix-scroll-area-viewport":"",...l,ref:a,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...e.style},children:t.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});xe.displayName=be;var L="ScrollAreaScrollbar",ge=i.forwardRef((e,o)=>{const{forceMount:r,...n}=e,s=E(L,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:d}=s,c=e.orientation==="horizontal";return i.useEffect(()=>(c?l(!0):d(!0),()=>{c?l(!1):d(!1)}),[c,l,d]),s.type==="hover"?t.jsx(Je,{...n,ref:o,forceMount:r}):s.type==="scroll"?t.jsx(Ge,{...n,ref:o,forceMount:r}):s.type==="auto"?t.jsx(ve,{...n,ref:o,forceMount:r}):s.type==="always"?t.jsx(re,{...n,ref:o}):null});ge.displayName=L;var Je=i.forwardRef((e,o)=>{const{forceMount:r,...n}=e,s=E(L,e.__scopeScrollArea),[l,d]=i.useState(!1);return i.useEffect(()=>{const c=s.scrollArea;let a=0;if(c){const f=()=>{window.clearTimeout(a),d(!0)},u=()=>{a=window.setTimeout(()=>d(!1),s.scrollHideDelay)};return c.addEventListener("pointerenter",f),c.addEventListener("pointerleave",u),()=>{window.clearTimeout(a),c.removeEventListener("pointerenter",f),c.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),t.jsx(G,{present:r||l,children:t.jsx(ve,{"data-state":l?"visible":"hidden",...n,ref:o})})}),Ge=i.forwardRef((e,o)=>{const{forceMount:r,...n}=e,s=E(L,e.__scopeScrollArea),l=e.orientation==="horizontal",d=q(()=>a("SCROLL_END"),100),[c,a]=Ve("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return i.useEffect(()=>{if(c==="idle"){const f=window.setTimeout(()=>a("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(f)}},[c,s.scrollHideDelay,a]),i.useEffect(()=>{const f=s.viewport,u=l?"scrollLeft":"scrollTop";if(f){let m=f[u];const h=()=>{const x=f[u];m!==x&&(a("SCROLL"),d()),m=x};return f.addEventListener("scroll",h),()=>f.removeEventListener("scroll",h)}},[s.viewport,l,a,d]),t.jsx(G,{present:r||c!=="hidden",children:t.jsx(re,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:o,onPointerEnter:W(e.onPointerEnter,()=>a("POINTER_ENTER")),onPointerLeave:W(e.onPointerLeave,()=>a("POINTER_LEAVE"))})})}),ve=i.forwardRef((e,o)=>{const r=E(L,e.__scopeScrollArea),{forceMount:n,...s}=e,[l,d]=i.useState(!1),c=e.orientation==="horizontal",a=q(()=>{if(r.viewport){const f=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;d(c?f:u)}},10);return M(r.viewport,a),M(r.content,a),t.jsx(G,{present:n||l,children:t.jsx(re,{"data-state":l?"visible":"hidden",...s,ref:o})})}),re=i.forwardRef((e,o)=>{const{orientation:r="vertical",...n}=e,s=E(L,e.__scopeScrollArea),l=i.useRef(null),d=i.useRef(0),[c,a]=i.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),f=Pe(c.viewport,c.content),u={...n,sizes:c,onSizesChange:a,hasThumb:f>0&&f<1,onThumbChange:h=>l.current=h,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:h=>d.current=h};function m(h,x){return tt(h,d.current,c,x)}return r==="horizontal"?t.jsx(Ke,{...u,ref:o,onThumbPositionChange:()=>{if(s.viewport&&l.current){const h=s.viewport.scrollLeft,x=ae(h,c,s.dir);l.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=m(h,s.dir))}}):r==="vertical"?t.jsx(qe,{...u,ref:o,onThumbPositionChange:()=>{if(s.viewport&&l.current){const h=s.viewport.scrollTop,x=ae(h,c);l.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=m(h))}}):null}),Ke=i.forwardRef((e,o)=>{const{sizes:r,onSizesChange:n,...s}=e,l=E(L,e.__scopeScrollArea),[d,c]=i.useState(),a=i.useRef(null),f=Y(o,a,l.onScrollbarXChange);return i.useEffect(()=>{a.current&&c(getComputedStyle(a.current))},[a]),t.jsx(we,{"data-orientation":"horizontal",...s,ref:f,sizes:r,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":K(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,m)=>{if(l.viewport){const h=l.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),je(h,m)&&u.preventDefault()}},onResize:()=>{a.current&&l.viewport&&d&&n({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:a.current.clientWidth,paddingStart:$(d.paddingLeft),paddingEnd:$(d.paddingRight)}})}})}),qe=i.forwardRef((e,o)=>{const{sizes:r,onSizesChange:n,...s}=e,l=E(L,e.__scopeScrollArea),[d,c]=i.useState(),a=i.useRef(null),f=Y(o,a,l.onScrollbarYChange);return i.useEffect(()=>{a.current&&c(getComputedStyle(a.current))},[a]),t.jsx(we,{"data-orientation":"vertical",...s,ref:f,sizes:r,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":K(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,m)=>{if(l.viewport){const h=l.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),je(h,m)&&u.preventDefault()}},onResize:()=>{a.current&&l.viewport&&d&&n({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:a.current.clientHeight,paddingStart:$(d.paddingTop),paddingEnd:$(d.paddingBottom)}})}})}),[Qe,Se]=me(L),we=i.forwardRef((e,o)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:s,onThumbChange:l,onThumbPointerUp:d,onThumbPointerDown:c,onThumbPositionChange:a,onDragScroll:f,onWheelScroll:u,onResize:m,...h}=e,x=E(L,r),[T,S]=i.useState(null),y=Y(o,P=>S(P)),v=i.useRef(null),w=i.useRef(""),R=x.viewport,I=n.content-n.viewport,g=z(u),N=z(a),O=q(m,10);function H(P){if(v.current){const A=P.clientX-v.current.left,b=P.clientY-v.current.top;f({x:A,y:b})}}return i.useEffect(()=>{const P=A=>{const b=A.target;T?.contains(b)&&g(A,I)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[R,T,I,g]),i.useEffect(N,[n,N]),M(T,O),M(x.content,O),t.jsx(Qe,{scope:r,scrollbar:T,hasThumb:s,onThumbChange:z(l),onThumbPointerUp:z(d),onThumbPositionChange:N,onThumbPointerDown:z(c),children:t.jsx(F.div,{...h,ref:y,style:{position:"absolute",...h.style},onPointerDown:W(e.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),v.current=T.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),H(P))}),onPointerMove:W(e.onPointerMove,H),onPointerUp:W(e.onPointerUp,P=>{const A=P.target;A.hasPointerCapture(P.pointerId)&&A.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=w.current,x.viewport&&(x.viewport.style.scrollBehavior=""),v.current=null})})})}),V="ScrollAreaThumb",ye=i.forwardRef((e,o)=>{const{forceMount:r,...n}=e,s=Se(V,e.__scopeScrollArea);return t.jsx(G,{present:r||s.hasThumb,children:t.jsx(Ze,{ref:o,...n})})}),Ze=i.forwardRef((e,o)=>{const{__scopeScrollArea:r,style:n,...s}=e,l=E(V,r),d=Se(V,r),{onThumbPositionChange:c}=d,a=Y(o,m=>d.onThumbChange(m)),f=i.useRef(void 0),u=q(()=>{f.current&&(f.current(),f.current=void 0)},100);return i.useEffect(()=>{const m=l.viewport;if(m){const h=()=>{if(u(),!f.current){const x=rt(m,c);f.current=x,c()}};return c(),m.addEventListener("scroll",h),()=>m.removeEventListener("scroll",h)}},[l.viewport,u,c]),t.jsx(F.div,{"data-state":d.hasThumb?"visible":"hidden",...s,ref:a,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:W(e.onPointerDownCapture,m=>{const x=m.target.getBoundingClientRect(),T=m.clientX-x.left,S=m.clientY-x.top;d.onThumbPointerDown({x:T,y:S})}),onPointerUp:W(e.onPointerUp,d.onThumbPointerUp)})});ye.displayName=V;var oe="ScrollAreaCorner",Ce=i.forwardRef((e,o)=>{const r=E(oe,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?t.jsx(et,{...e,ref:o}):null});Ce.displayName=oe;var et=i.forwardRef((e,o)=>{const{__scopeScrollArea:r,...n}=e,s=E(oe,r),[l,d]=i.useState(0),[c,a]=i.useState(0),f=!!(l&&c);return M(s.scrollbarX,()=>{const u=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(u),a(u)}),M(s.scrollbarY,()=>{const u=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(u),d(u)}),f?t.jsx(F.div,{...n,ref:o,style:{width:l,height:c,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function $(e){return e?parseInt(e,10):0}function Pe(e,o){const r=e/o;return isNaN(r)?0:r}function K(e){const o=Pe(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*o;return Math.max(n,18)}function tt(e,o,r,n="ltr"){const s=K(r),l=s/2,d=o||l,c=s-d,a=r.scrollbar.paddingStart+d,f=r.scrollbar.size-r.scrollbar.paddingEnd-c,u=r.content-r.viewport,m=n==="ltr"?[0,u]:[u*-1,0];return Te([a,f],m)(e)}function ae(e,o,r="ltr"){const n=K(o),s=o.scrollbar.paddingStart+o.scrollbar.paddingEnd,l=o.scrollbar.size-s,d=o.content-o.viewport,c=l-n,a=r==="ltr"?[0,d]:[d*-1,0],f=Ue(e,a);return Te([0,d],[0,c])(f)}function Te(e,o){return r=>{if(e[0]===e[1]||o[0]===o[1])return o[0];const n=(o[1]-o[0])/(e[1]-e[0]);return o[0]+n*(r-e[0])}}function je(e,o){return e>0&&e<o}var rt=(e,o=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return(function s(){const l={left:e.scrollLeft,top:e.scrollTop},d=r.left!==l.left,c=r.top!==l.top;(d||c)&&o(),r=l,n=window.requestAnimationFrame(s)})(),()=>window.cancelAnimationFrame(n)};function q(e,o){const r=z(e),n=i.useRef(0);return i.useEffect(()=>()=>window.clearTimeout(n.current),[]),i.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,o)},[r,o])}function M(e,o){const r=z(o);Oe(()=>{let n=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(n),s.unobserve(e)}}},[e,r])}var Ae=pe,ot=xe,Ne=ge,nt=ye,st=Ce;const Ee=i.forwardRef(({className:e,children:o,...r},n)=>t.jsxs(Ae,{ref:n,className:J("relative overflow-hidden",e),...r,children:[t.jsx(ot,{className:"h-full w-full rounded-[inherit]",children:o}),t.jsx(Re,{}),t.jsx(st,{})]}));Ee.displayName=Ae.displayName;const Re=i.forwardRef(({className:e,orientation:o="vertical",...r},n)=>t.jsx(Ne,{ref:n,orientation:o,className:J("flex touch-none select-none transition-colors",o==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",o==="horizontal"&&"h-2.5 border-t border-t-transparent p-[1px]",e),...r,children:t.jsx(nt,{className:"relative flex-1 rounded-full bg-border"})}));Re.displayName=Ne.displayName;function lt({testPlan:e,selectedItem:o,onSelect:r,onEdit:n,onAddTest:s,onAddAction:l,onReorderTests:d,onReorderActions:c,onDeleteTest:a,onDeleteAction:f}){const u=He(se(Fe),se(Be,{coordinateGetter:Xe})),[m,h]=Z.useState([]),x=Z.useRef(new Set);Z.useEffect(()=>{if(!e)return;const v=e.map(w=>w.testID).filter(w=>!x.current.has(w));v.length>0&&(h(w=>[...w,...v]),v.forEach(w=>x.current.add(w)))},[e]);const T=y=>{const{active:v}=y;v.id.toString().startsWith("T")&&h([])},S=y=>{const{active:v,over:w}=y;if(v.id!==w.id){const R=v.id.toString().startsWith("T"),I=v.id.toString().startsWith("A");R?d(v.id,w.id):I&&c(v.id,w.id)}};return!e||e.length===0?t.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:["No tests defined.",t.jsxs(_,{variant:"outline",className:"mt-4 w-full",onClick:s,children:[t.jsx(ee,{className:"mr-2 h-4 w-4"})," Add Test"]})]}):t.jsx(Me,{sensors:u,collisionDetection:Ye,onDragStart:T,onDragEnd:S,children:t.jsxs("div",{className:"space-y-2 p-2",children:[t.jsx(de,{items:e.map(y=>y.testID),strategy:ue,children:e.map((y,v)=>t.jsx(at,{test:y,isExpanded:m.includes(y.testID),onToggleExpand:()=>{h(w=>w.includes(y.testID)?w.filter(R=>R!==y.testID):[...w,y.testID])},selectedItem:o,onSelect:r,onEdit:n,onAddAction:l,onReorderActions:c,onDeleteTest:a,onDeleteAction:f},y.testID||v))}),t.jsxs(_,{variant:"secondary",className:"w-full mt-4",onClick:s,children:[t.jsx(ee,{className:"mr-2 h-4 w-4"})," Add Test"]})]})})}function at({test:e,isExpanded:o,onToggleExpand:r,selectedItem:n,onSelect:s,onEdit:l,onAddAction:d,onReorderActions:c,onDeleteTest:a,onDeleteAction:f}){const u=n===e,{attributes:m,listeners:h,setNodeRef:x,transform:T,transition:S,isDragging:y}=he({id:e.testID}),v={transform:fe.Transform.toString(T),transition:S,zIndex:y?50:1,opacity:y?.95:1,boxShadow:y?"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)":void 0},w=g=>{e.testTitle=g.target.value,l()},R=g=>{g.stopPropagation(),d(e)},I=e.testActions?e.testActions.map((g,N)=>g.actionID||`action-${e.testID}-${N}`):[];return t.jsxs("div",{ref:x,style:v,className:J("border-l-[6px] border-l-emerald-500 border rounded-md bg-card transition-colors mb-3 shadow-sm",u&&"ring-2 ring-emerald-500"),children:[t.jsxs("div",{className:"flex items-center p-2 bg-emerald-500/5 hover:bg-emerald-500/10 rounded-t-md cursor-pointer group border-b border-emerald-500/10",onClick:g=>{r(),s(e)},children:[t.jsx("div",{...m,...h,className:"mr-2 cursor-grab opacity-0 group-hover:opacity-100 hover:text-primary",onClick:g=>g.stopPropagation(),children:t.jsx(ie,{className:"h-4 w-4"})}),t.jsx("button",{onClick:g=>{g.stopPropagation(),r()},className:"p-1 mr-2 hover:bg-accent rounded",children:o?t.jsx(De,{className:"h-4 w-4"}):t.jsx(Ie,{className:"h-4 w-4"})}),t.jsx("input",{type:"checkbox",checked:e.isEnabled!==!1,onChange:g=>{e.isEnabled=g.target.checked,l()},onClick:g=>g.stopPropagation(),className:"mr-2 h-4 w-4 rounded border-primary text-primary focus:ring-primary"}),t.jsx(B,{value:e.testTitle,onChange:w,onFocus:()=>s(e),className:"h-7 px-2 py-1 font-medium border-transparent hover:border-input focus:border-input bg-transparent",onClick:g=>g.stopPropagation()}),t.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-2",onClick:R,title:"Add Action",children:t.jsx(ee,{className:"h-4 w-4"})}),t.jsx(_,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-1 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:g=>{g.stopPropagation(),a(e.testID)},title:"Delete Test",children:t.jsx(ce,{className:"h-3 w-3"})})]}),o&&t.jsxs("div",{className:"pl-8 pr-2 pb-2 space-y-1 relative",children:[t.jsx("div",{className:"absolute left-6 top-0 bottom-2 w-px bg-foreground/20"}),t.jsx(de,{items:I,strategy:ue,children:e.testActions&&e.testActions.map((g,N)=>t.jsx(it,{id:g.actionID||`action-${e.testID}-${N}`,action:g,selectedItem:n,onSelect:s,onEdit:l,onDeleteAction:f},g.actionID||N))}),(!e.testActions||e.testActions.length===0)&&t.jsx("div",{className:"text-xs text-muted-foreground italic py-1 pl-2",children:"No actions"})]})]})}function it({id:e,action:o,selectedItem:r,onSelect:n,onEdit:s,onDeleteAction:l}){const d=r===o,{attributes:c,listeners:a,setNodeRef:f,transform:u,transition:m,isDragging:h}=he({id:e}),x={transform:fe.Transform.toString(u),transition:m,zIndex:h?50:1,opacity:h?.95:1,boxShadow:h?"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)":void 0,backgroundColor:h?"hsl(var(--background))":void 0},T=S=>{o.actionTitle=S.target.value,s()};return t.jsxs("div",{ref:f,style:x,className:J("relative flex items-center p-2 my-1 rounded text-sm cursor-pointer border-l-[4px] border-l-amber-500 border border-transparent group ml-2 transition-colors","hover:bg-amber-500/10",d&&"bg-amber-500/20 border-amber-500/50"),onClick:()=>n(o),children:[t.jsx("div",{className:"absolute -left-4 top-1/2 w-4 h-px bg-foreground/20"}),t.jsx("div",{...c,...a,className:"mr-2 cursor-grab opacity-0 group-hover:opacity-100 hover:text-primary z-10",onClick:S=>S.stopPropagation(),children:t.jsx(ie,{className:"h-3 w-3"})}),t.jsx("input",{type:"checkbox",checked:o.isEnabled!==!1,onChange:S=>{o.isEnabled=S.target.checked,s()},onClick:S=>S.stopPropagation(),className:"mr-2 h-3 w-3 rounded border-primary text-primary focus:ring-primary"}),t.jsx(B,{value:o.actionTitle,onChange:T,onFocus:()=>n(o),className:"h-6 px-1 py-0 text-sm border-transparent hover:border-input focus:border-input bg-transparent flex-1",onClick:S=>S.stopPropagation()}),t.jsx(_,{variant:"ghost",size:"icon",className:"h-5 w-5 ml-1 opacity-0 group-hover:opacity-100 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:S=>{S.stopPropagation(),l(o.actionID)},title:"Delete Action",children:t.jsx(ce,{className:"h-3 w-3"})})]})}function mt({filename:e,onNavigate:o}){const[r,n]=i.useState({testPlan:[]}),[s,l]=i.useState(!0),[d,c]=i.useState(null),[a,f]=i.useState(null),[u,m]=i.useState(!1),[h,x]=i.useState(""),T=b=>(b.testPlan&&b.testPlan.forEach(p=>{p.testID||(p.testID=`T${Math.random().toString(36).substr(2,9)}`),p.testActions&&p.testActions.forEach((C,j)=>{C.actionID||(C.actionID=`A${Math.random().toString(36).substr(2,9)}`)})}),b),S=async()=>{try{l(!0);const b=await ne.getPlan(e),p=T(b);n(p),m(!1),c(null),f(null)}catch(b){c(b.message)}finally{l(!1)}};i.useEffect(()=>{S()},[e]);const y=async()=>{try{await ne.updatePlan(e,r),m(!1),x("Saved!"),setTimeout(()=>x(""),2e3)}catch(b){c(b.message)}},v=()=>{u&&!confirm("You have unsaved changes. Are you sure you want to leave?")||o("dashboard")},w=()=>{u&&!confirm("You have unsaved changes. Are you sure you want to discard them?")||S()},R=b=>{n({...r,title:b.target.value}),m(!0)},I=(b,p)=>{n(C=>{const j=C.testPlan.findIndex(D=>D.testID===b),k=C.testPlan.findIndex(D=>D.testID===p);if(j!==-1&&k!==-1){const D=le(C.testPlan,j,k);return{...C,testPlan:D}}return C}),m(!0)},g=(b,p)=>{n(C=>{const j={...C},k=j.testPlan.find(D=>D.testActions&&D.testActions.find(U=>U.actionID===b));if(k){const D=k.testActions.findIndex(Q=>Q.actionID===b),U=k.testActions.findIndex(Q=>Q.actionID===p);if(D!==-1&&U!==-1)return k.testActions=le(k.testActions,D,U),j}return C}),m(!0)},N=b=>{confirm("Are you sure you want to delete this test and all its actions?")&&(n(p=>({...p,testPlan:p.testPlan.filter(C=>C.testID!==b)})),f(null),m(!0))},O=b=>{confirm("Are you sure you want to delete this action?")&&(n(p=>{const C={...p};return C.testPlan.forEach(j=>{j.testActions&&(j.testActions=j.testActions.filter(k=>k.actionID!==b))}),C}),f(null),m(!0))},H=()=>{const b={testTitle:"New Test",testID:`T${Date.now()}`,isEnabled:!0,testActions:[]},p={...r};p.testPlan||(p.testPlan=[]),p.testPlan.push(b),n(p),m(!0),f(b)},P=b=>{const p={actionTitle:"New Action",actionType:"Click",actionID:`A${Date.now()}`,isEnabled:!0,params:X.get("Click")?JSON.parse(JSON.stringify(X.get("Click").defaultParams)):{}};b.testActions||(b.testActions=[]),b.testActions.push(p),n({...r}),m(!0),f(p)},A=()=>{if(!a)return t.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:t.jsx("p",{className:"text-lg font-medium",children:"Select a test or action to view details"})});const b=a.hasOwnProperty("testID");return t.jsxs("div",{className:"h-full flex flex-col p-6",children:[t.jsxs("div",{className:"mb-6 pb-4 border-b",children:[t.jsx("h2",{className:"text-2xl font-semibold tracking-tight",children:b?"Test Details":"Action Details"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:b?"Configure test properties.":"Configure action behavior."})]}),t.jsx("div",{className:"space-y-6",children:b?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Test Title"}),t.jsx(B,{value:a.testTitle,onChange:p=>{a.testTitle=p.target.value,n({...r}),m(!0)}})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"checkbox",id:"isEnabled",checked:a.isEnabled,onChange:p=>{a.isEnabled=p.target.checked,n({...r}),m(!0)},className:"h-4 w-4 rounded border-primary text-primary focus:ring-primary"}),t.jsx("label",{htmlFor:"isEnabled",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Enabled"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm font-medium leading-none",children:"Action Title"}),t.jsx(B,{value:a.actionTitle,onChange:p=>{a.actionTitle=p.target.value,n({...r}),m(!0)}})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm font-medium leading-none",children:"Action Type"}),t.jsx("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",value:a.actionType||"Click",onChange:p=>{const C=p.target.value;a.actionType=C;const j=X.get(C);j&&(a.params=JSON.parse(JSON.stringify(j.defaultParams))),n({...r}),m(!0)},children:X.getAll().map(p=>t.jsx("option",{value:p.type,children:p.label},p.type))})]}),(()=>{const p=X.get(a.actionType);if(p&&p.Editor){const C=p.Editor;return t.jsx("div",{className:"border rounded-md p-4 bg-accent/20",children:t.jsx(C,{params:a.params||{},onChange:j=>{a.params=j,n({...r}),m(!0)}})})}return t.jsxs("div",{className:"text-sm text-muted-foreground",children:["No editor available for action type: ",a.actionType]})})()]})})]})};return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("header",{className:"flex items-center justify-between border-b pb-4 mb-4 px-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(_,{variant:"ghost",size:"icon",onClick:v,children:t.jsx(ke,{className:"h-5 w-5"})}),t.jsx(B,{value:r.title,onChange:R,className:"text-2xl font-bold h-auto py-1 px-2 border-transparent hover:border-input focus:border-input w-[400px]"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[h&&t.jsx("span",{className:"text-sm text-green-500 font-medium animate-fade-out",children:h}),t.jsx(_,{variant:"outline",size:"icon",onClick:w,title:"Refresh",children:t.jsx(Le,{className:"h-4 w-4"})}),t.jsxs(_,{onClick:y,disabled:!u,title:"Save",children:[t.jsx(_e,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),t.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[t.jsx("aside",{className:"w-1/3 border-r flex flex-col bg-card/50",children:t.jsx(Ee,{className:"flex-1",children:t.jsx(lt,{testPlan:r.testPlan,selectedItem:a,onSelect:f,onEdit:()=>{m(!0),n({...r})},onAddTest:H,onAddAction:P,onReorderTests:I,onReorderActions:g,onDeleteTest:N,onDeleteAction:O})})}),t.jsx("main",{className:"flex-1 bg-background overflow-auto",children:A()})]})]})}export{mt as default};
